# 訪日外客者数の推移の分析

データの分析のための一連の流れにチャレンジします。最も面倒で手間であるデータ加工にチャレンジします。

# データの準備

以下よりファイルをダウンロードします。

[時系列推移表]の[国籍/月別 訪日外客数 (2003年-2023年) (Excel)]をダウンロードします。

https://www.jnto.go.jp/statistics/data/visitors-statistics/

ダウンロードしたファイルは、こちらにもあります。

Excelファイル: [ファイル](/[Plugin]%20Code%20Interpreter/data/since2003_visitor_arrivals_May_2023.xlsx)

# Prompt

Prompt:
```cmd
データの分析を行いたいです。Excelのファイルはあります。どんな手順で進めればよいですか?
```

Prompt:
```cmd
### 役割 ###
データエンジニアのプロフェッショナルとして振舞ってください。

### 指示 ###
アップロードしたExcelのデータのクレンジングをします。その後、データの分析に入ります。指示をするまで分析には入らないでください。
Step by Step で実行してください。
``````


## 1. ファイルのアップロード
ファイルをアップロードします。
それと当時に以下の Prompt を入力してみます。

Prompt:

```cmd
### 指示 ###
最初にアップロードしたファイルから、「年月日」「国名」「訪日外客数」をもつデータを作成します。グラフの中の全ての文字列は、このフォントを使ってください。

Excelファイルの特徴: ###
- このExcelファイルの1つのシートに1年分のデータがあります
- 最新の年は、入力が完了していないことがあります
- 各シートの上位３行は削除
- 2019年以前のシートと、2020年以降のシートで国名の列のレイアウトが異なっています
- 2020年以降のシートはA列に中東地域と北欧地域の下のB列に国名が入っている行があるので、その場合は、B列の文字列を国名にしてください
- 「伸率」「累計」も削除してください。
- 「総数」「計」「累計」などのデータは削除してください。
- 「中東地域」の行を削除します。集計行は不要です。
- 国名データの前後のスペースを削除してください。
- 年月日は、YYYY/MM/01という日付型に変換をしてください。
###
```


## 2. データの加工
最初の Prompt だけでも結構データの加工をしてくれます。行列変換や複数のシートのマージなど。凄いです。

出力データ次第ですが。
作成データの**RESULT**を確認して、適時指示をしていきます。

Prompt:
```cmd
作成されたデータの内容を確認したいので、基礎解析を行ってください。
```

データの内容がおかしいと思ったら、データを保存して、ダウンロードして内容を確認します。

Prompt:
```cmd
データをCSVの形式で保存してください。
```



## 3. データの分析実行


Prompt:

```cmd
データの分析に進みます。
さらに詳細な分析や視覚化を行います。

- 考えられる全ての分析をしてください。
- データの分析結果の説明文も作成してください。それぞれについてグラフを作成してください。
- 時系列の変化があるグラフは、よく使われているグラフを作成し、更にレーシングバーチャートも追加で作成してください。
- グラフの文字列は日本語で表示したいので、アップロードしたファイルの中のフォントのファイルを使ってください。
- Step by Step で実行してください。
```

もし、分析の次のタスクの提示がないようであれば。以下の様にタスクを指定します。

Prompt:

```cmd
可能な限りの基礎的な集計をします。その際に、時系列での傾向、旅行者の国ごと割合とその履歴、旅行者が日本を訪れる目的ごとの割合とその履歴、各種の構成比、地理的な分布、特性、相関関係などを分析してください。結果は最適なグラフで表示してください。グラフの文字列は日本語で表示したいので、アップロードしたファイルの中のフォンとファイルを使ってください。
```

Prompt:

```cmd
分析結果の特徴的な項目を3つリストアップして説明文を作成してください。
```

Propt:
```cmd
時系列の変化があるグラフは、レーシングバーチャートを作成してください。データの分析結果の説明文も作成してください。
Step by Step で実行してください。
```

## 4. 結果をファイルに出力

作業結果の保存です。

Prompt:
```cmd
### 指示 ###
これまでに作成したデータ分析結果を使ってPowerPointのスライドを作成します。python-pptxを使用してください。以下のプレゼンテーション構成の通り、スライドを作成してください。

プレゼンテーション構成:###
Step1: 全体のサマリーとFAQを作成して、最初のスライドに追加する
Step2: 特徴的な項目ごとに、スライドを作成する
Step3: それぞれのスライドはタイトル、データの概要説明文、グラフの画像で構成する
Step4: それぞれのスライドのタイトル、データの概要説明文を作成する
Step5: 作成したグラフを画像として、それぞれのスライドに追加する
###
```

あるいは
Prompt:

```cmd
ここまでの情報を考慮して、python-pptx を使用して、別のPowerPointファイルを作成してください。スライドは以下の構成にします。構成の各項目で不足している情報があったら、作成してください。

構成:###
ファイルのタイトル
全体の特徴的な項目。そしてFAQ
それぞれの項目を説明する概要文とグラフ
###
```

出力が途中で止まったら、作業を継続するように指示します。
```cmd
作業を続けて実行してください。
```

## 5. おまけ

時系列の変化があるグラフは、レーシングバーチャートも作成できます。


Prompt:
```cmd
以下の要件のダウンロード可能なファイルを作成してください。

要件:###
- .HTML のダッシュボード
- 日本語フォントの利用
- レーシングバーチャートのビジュアル
- データは1か月ごとになっているので、1年に合計をする
- ページは、機能的なデザインにする
- 装飾は必要最低限にする
- ビジュアルはグリッドのレイアウトにする
###
```


plotly を使ったHTMLダッシュボード作成も出来ます。

Prompt:
```cmd
以下の要件のダウンロード可能なファイルを作成してください。

要件:###
- .HTML のダッシュボード
- 日本語フォントの利用
- plotly を使ったインタラクティブなビジュアルにする
- ページは、機能的なデザインにする
- 装飾は必要最低限にする
- ビジュアルはグリッドのレイアウトにする
###
```

